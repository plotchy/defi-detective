[{"SourceCode":"pragma solidity 0.4.19;\r\n\r\ncontract FOMO3DLite {\r\n    using SafeMath for uint256;\r\n\r\n    event NewRound(\r\n        uint _timestamp,\r\n        uint _round,\r\n        uint _initialPot\r\n    );\r\n\r\n    event Bid(\r\n        uint _timestamp,\r\n        address _address,\r\n        uint _amount,\r\n        uint _newPot\r\n    );\r\n\r\n    event NewLeader(\r\n        uint _timestamp,\r\n        address _address,\r\n        uint _newPot,\r\n        uint _newDeadline\r\n    );\r\n\r\n    event Winner(\r\n        uint _timestamp,\r\n        address _address,\r\n        uint _earnings,\r\n        uint _deadline\r\n    );\r\n\r\n    event EarningsWithdrawal(\r\n        uint _timestamp,\r\n        address _address,\r\n        uint _amount\r\n    );\r\n\r\n    event DividendsWithdrawal(\r\n        uint _timestamp,\r\n        address _address,\r\n        uint _dividendShares,\r\n        uint _amount,\r\n        uint _newTotalDividendShares,\r\n        uint _newDividendFund\r\n    );\r\n\r\n    // Initial countdown duration at the start of each round\r\n    uint public constant BASE_DURATION = 1 days;\r\n\r\n    // Amount by which the countdown duration decreases per ether in the pot\r\n    uint public constant DURATION_DECREASE_PER_ETHER = 1 minutes;\r\n\r\n    // Minimum countdown duration\r\n    uint public constant MINIMUM_DURATION = 30 minutes;\r\n\r\n\r\n\r\n    // Minimum fraction of the pot required by a bidder to become the new leader\r\n    uint public constant MIN_LEADER_FRAC_TOP = 1;\r\n    uint public constant MIN_LEADER_FRAC_BOT = 1000000;\r\n\r\n    // Fraction of each bid put into the dividend fund\r\n    uint public constant DIVIDEND_FUND_FRAC_TOP = 40;\r\n    uint public constant DIVIDEND_FUND_FRAC_BOT = 100;\r\n\r\n    // Fraction of each bid taken for the developer fee\r\n    uint public constant DEVELOPER_FEE_FRAC_TOP = 15;\r\n    uint public constant DEVELOPER_FEE_FRAC_BOT = 100;\r\n\r\n    // Owner of the contract\r\n    address owner;\r\n\r\n    // Mapping from addresses to amounts earned\r\n    mapping(address => uint) public earnings;\r\n\r\n    // Mapping from addresses to dividend shares\r\n    mapping(address => uint) public dividendShares;\r\n\r\n    // Total number of dividend shares\r\n    uint public totalDividendShares;\r\n\r\n    // Value of the dividend fund\r\n    uint public dividendFund;\r\n\r\n    // Current round number\r\n    uint public round;\r\n\r\n    // Current value of the pot\r\n    uint public pot;\r\n\r\n    // Address of the current leader\r\n    address public leader;\r\n\r\n    // Time at which the current round expires\r\n    uint public deadline;\r\n\r\n    function FOMO3DLite() public payable {\r\n        require(msg.value > 0);\r\n        owner = msg.sender;\r\n        round = 1;\r\n        pot = msg.value;\r\n        leader = owner;\r\n        deadline = computeDeadline();\r\n        NewRound(now, round, pot);\r\n        NewLeader(now, leader, pot, deadline);\r\n    }\r\n\r\n    function computeDeadline() internal view returns (uint) {\r\n        uint _durationDecrease = DURATION_DECREASE_PER_ETHER.mul(pot.div(1 ether));\r\n        uint _duration;\r\n        if (MINIMUM_DURATION.add(_durationDecrease) > BASE_DURATION) {\r\n            _duration = MINIMUM_DURATION;\r\n        } else {\r\n            _duration = BASE_DURATION.sub(_durationDecrease);\r\n        }\r\n        return now.add(_duration);\r\n    }\r\n\r\n    modifier advanceRoundIfNeeded {\r\n        if (now > deadline) {\r\n            uint _nextPot = 0;\r\n            uint _leaderEarnings = pot.sub(_nextPot);\r\n            Winner(now, leader, _leaderEarnings, deadline);\r\n            earnings[leader] = earnings[leader].add(_leaderEarnings);\r\n            round++;\r\n            pot = _nextPot;\r\n            leader = owner;\r\n            deadline = computeDeadline();\r\n            NewRound(now, round, pot);\r\n            NewLeader(now, leader, pot, deadline);\r\n        }\r\n        _;\r\n    }\r\n\r\n    function bid() public payable advanceRoundIfNeeded {\r\n        uint _minLeaderAmount = pot.mul(MIN_LEADER_FRAC_TOP).div(MIN_LEADER_FRAC_BOT);\r\n        uint _bidAmountToDeveloper = msg.value.mul(DEVELOPER_FEE_FRAC_TOP).div(DEVELOPER_FEE_FRAC_BOT);\r\n        uint _bidAmountToDividendFund = msg.value.mul(DIVIDEND_FUND_FRAC_TOP).div(DIVIDEND_FUND_FRAC_BOT);\r\n        uint _bidAmountToPot = msg.value.sub(_bidAmountToDeveloper).sub(_bidAmountToDividendFund);\r\n\r\n        earnings[owner] = earnings[owner].add(_bidAmountToDeveloper);\r\n        dividendFund = dividendFund.add(_bidAmountToDividendFund);\r\n        pot = pot.add(_bidAmountToPot);\r\n        Bid(now, msg.sender, msg.value, pot);\r\n\r\n        if (msg.value >= _minLeaderAmount) {\r\n            uint _dividendShares = msg.value.div(_minLeaderAmount);\r\n            dividendShares[msg.sender] = dividendShares[msg.sender].add(_dividendShares);\r\n            totalDividendShares = totalDividendShares.add(_dividendShares);\r\n            leader = msg.sender;\r\n            deadline = computeDeadline();\r\n            NewLeader(now, leader, pot, deadline);\r\n        }\r\n    }\r\n\r\n    function withdrawEarnings() public advanceRoundIfNeeded {\r\n        require(earnings[msg.sender] > 0);\r\n        assert(earnings[msg.sender] <= this.balance);\r\n        uint _amount = earnings[msg.sender];\r\n        earnings[msg.sender] = 0;\r\n        msg.sender.transfer(_amount);\r\n        EarningsWithdrawal(now, msg.sender, _amount);\r\n    }\r\n\r\n    function withdrawDividends() public {\r\n        require(dividendShares[msg.sender] > 0);\r\n        uint _dividendShares = dividendShares[msg.sender];\r\n        assert(_dividendShares <= totalDividendShares);\r\n        uint _amount = dividendFund.mul(_dividendShares).div(totalDividendShares);\r\n        assert(_amount <= this.balance);\r\n        dividendShares[msg.sender] = 0;\r\n        totalDividendShares = totalDividendShares.sub(_dividendShares);\r\n        dividendFund = dividendFund.sub(_amount);\r\n        msg.sender.transfer(_amount);\r\n        DividendsWithdrawal(now, msg.sender, _dividendShares, _amount, totalDividendShares, dividendFund);\r\n    }\r\n}\r\n\r\n/**\r\n * @title SafeMath\r\n * @dev Math operations with safety checks that throw on error\r\n */\r\nlibrary SafeMath {\r\n    /**\r\n    * @dev Multiplies two numbers, throws on overflow.\r\n    */\r\n    function mul(uint256 a, uint256 b) internal pure returns (uint256) {\r\n        if (a == 0) {\r\n            return 0;\r\n        }\r\n        uint256 c = a * b;\r\n        assert(c / a == b);\r\n        return c;\r\n    }\r\n\r\n    /**\r\n    * @dev Integer division of two numbers, truncating the quotient.\r\n    */\r\n    function div(uint256 a, uint256 b) internal pure returns (uint256) {\r\n        // assert(b > 0); // Solidity automatically throws when dividing by 0\r\n        uint256 c = a / b;\r\n        // assert(a == b * c + a % b); // There is no case in which this doesn't hold\r\n        return c;\r\n    }\r\n\r\n    /**\r\n    * @dev Substracts two numbers, throws on overflow (i.e. if subtrahend is greater than minuend).\r\n    */\r\n    function sub(uint256 a, uint256 b) internal pure returns (uint256) {\r\n        assert(b <= a);\r\n        return a - b;\r\n    }\r\n\r\n    /**\r\n    * @dev Adds two numbers, throws on overflow.\r\n    */\r\n    function add(uint256 a, uint256 b) internal pure returns (uint256) {\r\n        uint256 c = a + b;\r\n        assert(c >= a);\r\n        return c;\r\n    }\r\n}","ABI":"[{\"constant\":true,\"inputs\":[],\"name\":\"BASE_DURATION\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"round\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"bid\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"dividendFund\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"deadline\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"MINIMUM_DURATION\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"withdrawDividends\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"MIN_LEADER_FRAC_TOP\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"leader\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"pot\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"earnings\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"DEVELOPER_FEE_FRAC_TOP\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"withdrawEarnings\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"DIVIDEND_FUND_FRAC_BOT\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalDividendShares\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"DIVIDEND_FUND_FRAC_TOP\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"DEVELOPER_FEE_FRAC_BOT\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"DURATION_DECREASE_PER_ETHER\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"dividendShares\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"MIN_LEADER_FRAC_BOT\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_timestamp\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_round\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_initialPot\",\"type\":\"uint256\"}],\"name\":\"NewRound\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_timestamp\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_address\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_amount\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_newPot\",\"type\":\"uint256\"}],\"name\":\"Bid\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_timestamp\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_address\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_newPot\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_newDeadline\",\"type\":\"uint256\"}],\"name\":\"NewLeader\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_timestamp\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_address\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_earnings\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_deadline\",\"type\":\"uint256\"}],\"name\":\"Winner\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_timestamp\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_address\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"EarningsWithdrawal\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_timestamp\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_address\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_dividendShares\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_amount\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_newTotalDividendShares\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"_newDividendFund\",\"type\":\"uint256\"}],\"name\":\"DividendsWithdrawal\",\"type\":\"event\"}]","ContractName":"FOMO3DLite","CompilerVersion":"v0.4.19+commit.c4cbbb05","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","EVMVersion":"Default","Library":"","LicenseType":"","Proxy":"0","Implementation":"","SwarmSource":"bzzr://c5c47d421965667ae3e950d234570062bdcc22babca8e07c28c12cef2424ffb9"}]